<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Parameter Configuration</title>

    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <style>
        .wrap {
            width: 450px;
            padding-top: 30px;
        }

        .item {
            height: 30px;
        }

        .first {
            width: 50%;
            float: left;
            height: 400px;
            /*border: 1px solid #3B6273;*/
        }

        .second {
            width: 50%;
            float: left;
            height: 400px;
            /*border: 1px solid #3B6273;*/
        }

        label {
            width: 250px;
            display: inline-block;
            text-align: right;
            padding-right: 5px;
            font-weight: bold;
        }

        .top input {
            width: 130px;
        }

        /* Tooltip 容器 */
        .my_tooltip {
            position: relative;
            width: 250px;
            display: inline-block;
            text-align: right;
            padding-right: 5px;
            font-weight: bold;
            /*border-bottom: 1px dotted black; !* 悬停元素上显示点线 *!*/
        }

        /* Tooltip 文本 */
        .my_tooltip .tooltiptext {
            visibility: hidden;
            width: 120px;
            background-color: #3cb371;
            color: #fff;
            text-align: center;
            padding: 5px 0;
            border-radius: 6px;

            /* 定位 */
            position: absolute;
            z-index: 1;

            top: -5px;
            right: 30%;
        }

        /* 鼠标移动上去后显示提示框 */
        .my_tooltip:hover .tooltiptext {
            visibility: visible;
        }
    </style>
</head>


<body>
<br>
<div class="container" style="border: 2px solid black; width: 1180px; height: 680px;">
    <nav class="navbar navbar-fix-top">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar"
                        aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" rel="home" href="#" title="Buy Sell Rent Everyting">
                    <!--                    <img style="max-width:100px; margin-top: -7px;" src="/static/logo_black.png">-->
                    <h1 style="max-width:100px; margin-top: -7px;">UniView</h1>
                </a>                    <!-- <a class="navbar-brand" href="#">DeepO</a> -->
            </div>
            <p></p>
            <p></p>
            <div id="navbar" class="navbar-collapse collapse">
                <div class="nav nav-pills navbar-right">
                    <li role="presentation" class="nav-item active"><a href="#">Parameter
                        Configuration</a></li>
                    <li><a href="MV_process_tracking.html">MV Process Tracking</a></li>
                    <li><a href="MV_results_evaluation.html">MV Results Evaluation</a></li>
                    <li><a href="MV_history.html">MV History</a></li>
                </div>
                <!-- <form class="navbar-form navbar-right">
            <input type="text" class="form-control" placeholder="Search..."> -->
                <!-- </form> -->
            </div>
        </div>
    </nav>
    <br>
    <div class="main">
        <div class="btn-toolbar" role="toolbar">
            <div>
                <div class="row marketing">
                    <div class="col-lg-12">
                        <div class="panel panel-primary" style="height: 470px;">
                            <div class="panel-heading">Parameter Configuration</div>

                            <div class="first">
                                <div class="my_tooltip" style="font-size:15px; margin-top: 30px;">
                                    Engine
                                    <span class="tooltiptext">Select a database engine</span>
                                </div>

                                <input type="radio" id="engine1" name="engine" value="Spark"/>
                                <span style="font-size:15px; display:inline-block;width: 50px; height: 20px;margin-right: 20px;">Spark</span>
                                <input type="radio" id="engine2" name="engine" value="PostgreSQL"/>
                                <span style="font-size:15px; display:inline-block;width: 80px;margin-right: 20px;">PostgreSQL</span>
                                <input type="radio" id="engine3" name="engine" value="ClickHouse"/>
                                <span style="font-size:15px; display:inline-block;width: 70px;">ClickHouse</span>
                                <br><br>

                                <div class="my_tooltip" style="font-size:15px; margin-top: 30px;">
                                    Single or multiple
                                    <span class="tooltiptext">Select table mode</span>
                                </div>
                                <input type="radio" id="single_or_multiple1" name="single_or_multiple" value="single"/>
                                <span style="font-size:15px; display:inline-block;width: 50px; height: 20px;margin-right: 20px;">
                                        Single
                                    </span>
                                <input type="radio" id="single_or_multiple2" name="single_or_multiple"
                                       value="multiple"/>
                                <span style="font-size:15px; display:inline-block;width: 70px;margin-right: 20px;">
                                        Multiple
                                    </span>
                                <br><br>

                                <div class="my_tooltip" style="font-size:15px; margin-top: 30px;">
                                    Num of train
                                    <span class="tooltiptext">Number of training samples</span>
                                </div>
                                <input type="text" id="num_train" name="num_train"
                                       placeholder="default:100">
                                <br><br>

                                <div class="my_tooltip" style="font-size:15px; margin-top: 30px;">
                                    Space limit
                                    <span class="tooltiptext">Space limit M</span>
                                </div>
                                <input type="text" id="space_limit" name="space_limit"
                                       placeholder="default:1024">
                                <br><br>

                                <div class="my_tooltip" style="font-size:15px; margin-top: 30px;">
                                    Table size upper bound
                                    <span class="tooltiptext">The threshold for distinguishing between large and small tables. A table with a size of more than 1G is a large table, and a table with a size of less than 10M is a small table.</span>
                                </div>
                                <input type="text" id="table_size_upper_bound"
                                       name="table_size_upper_bound"
                                       placeholder="default:50000000">
                                <br><br>

                            </div>

                            <div class="second">
                                <div class="my_tooltip" style="font-size:15px; margin-top: 30px;">
                                    Recommend method
                                    <span class="tooltiptext">Select a recommend method</span>
                                </div>
                                <input type="radio" id="recommend_method1" name="recommend_method" value="greedy"/>
                                    <span style="font-size:15px; display:inline-block;width: 50px; height: 20px;margin-right: 20px;">
                                        Greedy
                                    </span>
                                <input type="radio" id="recommend_method2" name="recommend_method" value="RL"/>
                                    <span style="font-size:15px; display:inline-block;width: 70px;margin-right: 20px;">
                                        RL
                                    </span>
                                <br><br>

                                <div class="my_tooltip" style="font-size:15px; margin-top: 30px;">
                                    Num of epoch
                                    <span class="tooltiptext">Number of training rounds</span>
                                </div>
                                <input type="text" id="epoch" name="epoch"
                                       placeholder="default:5">
                                <br><br>

                                <div class="my_tooltip" style="font-size:15px; margin-top: 30px;">
                                    Cnt limit
                                    <span class="tooltiptext">The limit of topN's MV</span>
                                </div>
                                <input type="text" id="cnt_limit" name="cnt_limit"
                                       placeholder="default:30">
                                <br><br>

                                <div class="my_tooltip" style="font-size:15px; margin-top: 30px;">
                                    Refer threshold
                                    <span class="tooltiptext">Subtrees whose reference count is less than ref_threshold will not be used as candidate views</span>
                                </div>
                                <input type="text" id="refer_threshold" name="refer_threshold"
                                       placeholder="default:1">
                                <br><br>

                                <div class="my_tooltip" style="font-size:15px; margin-top: 30px;">
                                    Table size lower bound
                                    <span class="tooltiptext">The threshold for distinguishing between large and small tables. A table with a size of more than 1G is a large table, and a table with a size of less than 10M is a small table.</span>
                                </div>
                                <input type="text" id="table_size_lower_bound"
                                       name="table_size_lower_bound"
                                       placeholder="default:10485760">
                                <br><br>


                            </div>

                        </div>

                    </div>
                </div>
            </div>
        </div>
        <div class="btn-toolbar">
            <button type="button" id="saveParameters" class="btn btn-secondary" data-loading-text="Loading..."
                    style="margin-left: 250px;background-color:#337ab7; color:white; width: 200px;
	                    height: 45px; border:0; font-size: 22px; box-sizing: content-box; border-radius: 5px;">
                <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                Save parameters
            </button>
            <button type="button" id="defaultParameters" class="btn btn-secondary" data-toggle="modal"
                    data-target="#exampleModalCenter" style="margin-left: 250px;background-color:#337ab7;
	            color:white;
	            width: 200px;
	            height: 45px;
	            border:0;
	            font-size: 22px;
	            box-sizing: content-box;
                border-radius: 5px;">
                Default parameters
            </button>

            <div id="output"></div>
        </div>
    </div>


</div>

<br>
</div>

</body>

<script>
    var saveParameters = document.getElementById("saveParameters");
    var defaultParameters = document.getElementById("defaultParameters");

    function getValueFromRatios(radios) {
        var value = 0;
        for (var i = 0; i < radios.length; i++) {
            if (radios[i].checked == true) {
                value = radios[i].value;
                break;
            }
        }
        return value;
    }

    function chooseRatio(radios, value) {
        for (var i = 0; i < radios.length; i++){
            if (radios[i].value == value){
                radios[i].checked = true;
                break;
            }
        }
    }

    saveParameters.onclick = function () {
        var radios_engine = document.getElementsByName("engine");
        var engine = getValueFromRatios(radios_engine);

        var radios_recommend_method = document.getElementsByName("recommend_method");
        var recommend_method = getValueFromRatios(radios_recommend_method);

        var radios_single_or_multiple = document.getElementsByName("single_or_multiple");
        var single_or_multiple = getValueFromRatios(radios_single_or_multiple);

        var epoch = window.document.getElementById("epoch").value;
        var num_train = window.document.getElementById("num_train").value;
        var cnt_limit = window.document.getElementById("cnt_limit").value;
        var space_limit = window.document.getElementById("space_limit").value;
        var refer_threshold = window.document.getElementById("refer_threshold").value;
        var table_size_upper_bound = window.document.getElementById("table_size_upper_bound").value;
        var table_size_lower_bound = window.document.getElementById("table_size_lower_bound").value;

        alert("save parameters success!");

        // $.ajax({
        //     // 替换url
        //     url: "http://110.42.138.127:5000/save_parameters",
        //     type: 'POST',
        //     dataType: 'json',
        //     crossDomain: true,
        //     contentType: 'application/json;charset=UTF-8',
        //     data: JSON.stringify({
        //         "engine": engine, 
        //         "recommend_method": recommend_method, 
        //         "single_or_multiple": single_or_multiple,
        //         "epoch": parseInt(epoch), 
        //         "num_train": parseInt(num_train), 
        //         "cnt_limit": parseInt(cnt_limit), 
        //         "space_limit": parseInt(space_limit),
        //         "refer_threshold": parseInt(refer_threshold), 
        //         "table_size_upper_bound": parseInt(table_size_upper_bound),
        //         "table_size_lower_bound": parseInt(table_size_lower_bound)
        //     }),
        //     success: function (res) {
        //         // 根据res返回值判断何种状态
        //         if(res.code === 200){
        //             alert(res.msg);
        //             console.log(res)
        //         }
        //         else if(res.code === 401){
        //             alert(res.msg);
        //         }
        //     },
        //     error: function (e) {
        //         alert("server error");
        //         console.log(e.responseText);
        //     }
        // });
    }

    defaultParameters.onclick = function () {
        var radios_engine = document.getElementsByName("engine");
        var radios_recommend_method = document.getElementsByName("recommend_method");
        var radios_single_or_multiple = document.getElementsByName("single_or_multiple");

        chooseRatio(radios_engine, "PostgreSQL");
        chooseRatio(radios_recommend_method, "RL");
        chooseRatio(radios_single_or_multiple, "multiple");
        window.document.getElementById("epoch").value = 5;
        window.document.getElementById("num_train").value = 100;
        window.document.getElementById("cnt_limit").value = 30;
        window.document.getElementById("space_limit").value = 1024;
        window.document.getElementById("refer_threshold").value = 1;
        window.document.getElementById("table_size_upper_bound").value = 50000000;
        window.document.getElementById("table_size_lower_bound").value = 10485760;
    }


    function change(change) {
        var oObj = window.event.srcElement;
        //alert(change.tagName.toLowerCase());
        if (oObj.tagName.toLowerCase() == "td") {
            var oTr = oObj.parentNode;
            for (var i = 0; i < document.all.form.rows.length; i++) {
                document.all.form.rows[i].style.backgroundColor = "";
                document.all.form.rows[i].tag = false;
            }
            submit_num = oObj.parentElement.rowIndex;
            console.log(submit_num);
            oTr.style.backgroundColor = "#CCCCFF";
            oTr.tag = true;
        }
    }

    //鼠标点击另外一行时关闭已选行变色
    function out() {
        var oObj = event.srcElement;
        if (oObj.tagName.toLowerCase() == "td") {
            var oTr = oObj.parentNode;
            if (!oTr.tag) oTr.style.backgroundColor = "";
        }
    }

    //鼠标移动到选择行上时的行变色
    function over() {
        var oObj = event.srcElement;
        if (oObj.tagName.toLowerCase() == "td") {
            var oTr = oObj.parentNode;
            if (!oTr.tag) oTr.style.backgroundColor = "#E1E9FD";
        }
    }


</script>
